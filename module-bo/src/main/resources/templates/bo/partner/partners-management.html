<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/mainLayout}">
<div layout:fragment="contents" th:remove="tag">
    <div id="container">
        <div class="hstack justify-content-between gap-4">
            <div class="page-top">
                <h1 class="page-title">파트너스 광고 관리</h1>
            </div>
        </div>
        <form name="searchForm">
            <input type="hidden" name="page" th:value="${searchInfo.page}"/>
        <!-- filter -->
            <div class="filter">
                <div class="row align-items-center">
                    <div class="col-12 col-lg d-flex justify-content-between">
                        <div class="d-flex flex-wrap gap-4">
                            <div class="btn-calendar" role="group" style="min-width: 80px">
                                <button aria-label="이전달" class="" type="button" onclick="changeDate(-1)">
                                    <i class="icon-calendar-prev day"></i>
                                </button>
                                <p class="date" name="searchDate" id="displayDate" th:text="${searchInfo.searchDate}"></p>
                                <input type="hidden" name="searchDate" id="searchDateInput" th:value="${searchInfo.searchDate}">
                                <button aria-label="다음달" class="" type="button" onclick="changeDate(1)">
                                    <i class="icon-calendar-next day"></i>
                                </button>
                            </div>
                        </div>
                        <div class="d-flex flex-wrap gap-4">
                            <div class="filter-item">
                                <select class="form-select" name="searchType" data-placeholder="선택하세요." autocomplete="off">
                                    <option value="" selected>전체</option>
                                    <option value="partnersName">파트너스명</option>
                                    <option value="title">프로젝트명</option>
                                </select>
                            </div>
                            <div class="form-field d-flex gap-2">
                                <div class="input-form">
                                    <input type="text" class="form-control remove-form" name="searchText" th:value="${searchInfo.searchText}" placeholder="검색​"/>
                                    <button type="button" class="clear-button">
                                        <i class="icon-input-close"></i>
                                    </button>
                                </div>
                                <button type="button" class="btn btn-outline-gray px-3" aria-label="검색" data-role="btn-search-form">
                                    <i class="icon-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <!-- //filter -->
        </form>

        <div class="row">
            <div class="col-12 col-xl-8 mb-4 mb-lg-0">
                <div class="card today-current-situation lg justify-content-center">
                    <ul class="today-list">
                        <li>
                            <p class="cnt text-gray2" th:text="${partnerAdInfo.bidCnt}">3</p>
                            <p class="title">입찰중​</p>
                        </li>
                        <li>
                            <p class="cnt text-orange" th:text="${partnerAdInfo.progressCnt}">2</p>
                            <p class="title">진행중​</p>
                        </li>
                        <li class="title">
                            <p class="cnt text-danger" th:text="${partnerAdInfo.completeCnt}">10</p>
                            <p>
                                진행 완료​<br/>
                                (검수필요)
                            </p>
                        </li>
                        <li class="title">
                            <p class="cnt text-primary" th:text="${partnerAdInfo.billingCnt}">2</p>
                            <p>정산 완료​</p>
                        </li>
                        <li class="title">
                            <p class="cnt text-primary" th:text="${partnerAdInfo.cancelCnt}">2</p>
                            <p>결제 취소​</p>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-12 col-xl-4">
                <div class="table-responsive-xxl tbody-mode">
                    <table class="table table-hover">
                        <colgroup>
                            <col width="40%"/>
                        </colgroup>
                        <tbody>
                        <tr class="cursor-pointer">
                            <th class="text-center">총 판매 금액</th>
                            <td class="text-end">
                                <p class="total-price" th:text="${#numbers.formatInteger(partnerAdAmountInfo.totalAmount, 0, 'COMMA') + '원'}">1,120,000원</p>
                            </td>
                        </tr>
                        <tr class="cursor-pointer">
                            <th class="text-center">정산 완료 금액</th>
                            <td class="text-end">
                                <p class="total-price" th:text="${#numbers.formatInteger(partnerAdAmountInfo.billingAmount, 0, 'COMMA') + '원'}">1,120,000원</p>
                            </td>
                        </tr>
                        <tr class="cursor-pointer">
                            <th class="text-center">입금 예정 금액</th>
                            <td class="text-end">
                                <p class="total-price" th:text="${#numbers.formatInteger(partnerAdAmountInfo.bidAmount, 0, 'COMMA') + '원'}">1,120,000원</p>
                            </td>
                        </tr>
                        <tr class="cursor-pointer">
                            <th class="text-center">진행 중인 금액</th>
                            <td class="text-end">
                                <p class="total-price" th:text="${#numbers.formatInteger(partnerAdAmountInfo.progressAmount, 0, 'COMMA') + '원'}">1,120,000원</p>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <p class="text-danger mt-6">입찰중 : 입찰 신청한 상태 / 진행중 : 고객 결제 완료 / 진행 완료 : 유앤엠 검수 완료 / 정산 완료 :파트너스 대금 지급 완료 / 결제 취소
            : 고객 결제 취소​</p>
        <!-- table -->
        <div class="scroll-layout mt-4">
            <div class="scroll-content">
                <div class="list-table">
                    <table class="table table-hover">
                        <thead>
                        <tr class="cursor-pointer">
                            <th class="text-center">상태</th>
                            <th class="text-center">주문번호</th>
                            <th class="text-center">상태 변경​</th>
                            <th class="text-center">프로젝트명</th>
                            <th class="text-center">파트너스 명</th>
                            <th class="text-center">프로젝트 금액</th>
                            <th class="text-center">입찰 금액</th>
                            <th class="text-center">보고서</th>
                        </tr>
                        </thead>
                        <tbody>
                        <th:block th:if="${#lists.isEmpty(partnerList)}">
                            <tr>
                                <td colspan="8" class="text-center">내역이 없습니다.</td>
                            </tr>
                        </th:block>
                        <tr class="cursor-pointer" th:each="list : ${partnerList}">
                            <td class="text-center" th:if="${list.status == 'BID'}">
                                <span class="badge rounded-pill badge-outline-brand">입찰중</span>
                            </td>
                            <td class="text-center" th:if="${list.status == 'PROGRESS'}">
                                <span class="badge rounded-pill badge-outline-gray3">진행중</span>
                            </td>
                            <td class="text-center" th:if="${list.status == 'COMPLETE'}">
                                <span class="badge rounded-pill badge-outline-brand">진행완료</span>
                            </td>
                            <td class="text-center" th:if="${list.status == 'BILLING'}">
                                <span class="badge rounded-pill badge-outline-orange500">정산완료</span>
                            </td>
                            <td class="text-center" th:if="${list.status == 'CANCEL'}">
                                <span class="badge rounded-pill badge-outline-danger">결제취소</span>
                            </td>
                            <td class="text-center">
                                <p th:text="${list.orderNo}">24061901</p>
                            </td>
                            <td class="text-center">
                                <a data-toggle="modal" data-target="#modal-state-change" th:data-partners-id="${list.partnersId}" th:data-ad-id="${list.adId}" th:text="${list.statusChangeDt}">2023.12.13(수) 16:00</a>
                            </td>
                            <td class="text-center">
                                <a href="" class="text-primary" th:text="${list.title}" data-role="detail" th:data-ad-id="${list.adId}" >외식업 프랜차이즈​ 블로그 상위노출</a>
                            </td>
                            <td class="text-center" th:text="${list.name}">제일광고</td>
                            <td class="text-center" th:text="${#numbers.formatInteger(list.amount, 0, 'COMMA') + '원'}">1,000,000 원</td>
                            <td class="text-center" th:text="${#numbers.formatInteger(list.budget, 0, 'COMMA') + '원'}">800,000원</td>
                            <th:block th:if="${list.reportStatus != 'PENDING'}">
                                <td class="text-center">
                                    <a href="" class="text-primary"th:text="${list.reportStatusName}" data-role="report" th:data-ad-id="${list.adId}" th:data-partners-id="${list.partnersId}">미제출</a>
                                </td>
                            </th:block>
                            <th:block th:if="${list.reportStatus == 'PENDING'}">
                                <td class="text-center">
                                    <a href=""  data-role="noReport" class="text-center" th:text="${list.reportStatusName}">미제출</a>
                                </td>
                            </th:block>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="d-flex justify-content-center mt-5">
            <th:block th:replace="fragments/paging :: paging_Fragment"/>
        </div>
    </div>
    <div class="modal" tabindex="-1" id="modal-state-change">
        <div class="modal-dialog modal-dialog-centered modal-md modal-dialog-scrollable modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="btn-close" data-dismiss="modal" aria-label="Close" data-role="close"></button>
                </div>
                <div class="modal-body pt-0 pb-0">
                    <table class="table table-bordered">
                        <colgroup>
                            <col width="50%">
                            <col width="50%">
                        </colgroup>
                        <thead>
                        <tr>
                            <th class="text-center">시간</th>
                            <th class="text-center">상태</th>
                        </tr>
                        </thead>
                        <tbody id="status-change-tbody">
                        <!-- Ajax로 동적으로 채워질 영역 -->
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer d-flex align-items-center justify-content-center">
                    <button type="button" class="btn btn-primary" data-dismiss="modal" data-role="close">닫기</button>
                </div>
            </div>
        </div>
    </div>
</div>
</html>